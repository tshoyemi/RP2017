!function (a, b, c) { "use strict"; a.rbw = a.rbw || {}, a.rbw.slickListingImageCarousel = { listings: {}, lazyLoadListingImagesTimer: null, init: function (c) { function f() { e.carouselEle.slick({ accessibility: false, dots: e.slick.dots, infinite: e.slick.infinite, speed: e.slick.speed, slidesToShow: e.slick.slidesToShow, slidesToScroll: e.slick.slidesToScroll, variableWidth: e.slick.variableWidth, centerMode: e.slick.centerMode, prevArrow: e.slick.prevArrow, nextArrow: e.slick.nextArrow }) } var d = this, e = b.extend(!0, {}, { lazyLoadImages: !0, lazyImageTemplate: '<div><img id="img_{listingId}_{displaySequence}" border="0" alt="MLS: {listingNumber}" data-lazy="{filePath}" /></div>', slick: { dots: !1, infinite: !0, speed: 300, slidesToShow: 1, slidesToScroll: 1, variableWidth: !1, centerMode: !1, prevArrow: '<button type="button" data-role="none" class="r-cta-icon slick-prev" aria-label="Previous" tabindex="0" role="button"></button>', nextArrow: '<button type="button" data-role="none" class="r-cta-icon slick-next" aria-label="Next" tabindex="0" role="button"></button>' } }, c); if (!e.carouselEle || !e.listingId) throw "rbw.slickCarousel exception: 'carouselEle' and 'listingId' are required properties of rbw.slickCarousel.init's options argument."; d.listings[e.listingId] = b.extend(!0, {}, { lazyLoadImages: !1, carouselEle: e.carouselEle, selectedImage: 0, loadedImages: 0, lazyImageTemplate: e.lazyImageTemplate }, d.listings[e.listingId] || {}), e.carouselEle.on({ init: function () { a.setTimeout(function () { e.carouselEle.slick("setPosition"), d.listings[e.listingId] && (d.listings[e.listingId].lazyLoadImages = e.lazyLoadImages) }, 1) }, afterChange: function () { var a = arguments[2]; d.listings[e.listingId].selectedImage = a, e.currentPhotoEle && e.currentPhotoEle.text(a + 1) } }), f() }, lazyLoadListingImagesInView: function () { function f() { function c(b) { b = b[0]; var c = b.getBoundingClientRect().top, d = b.getBoundingClientRect().bottom, e = c < a.innerHeight && d >= 0; return e } return b.map(d.listings, function (a, b) { if (a.carouselEle && a.lazyLoadImages && c(a.carouselEle)) return b }) } function g(a) { return 0 === d.listings[a].loadedImages } function h() { function a(a, c) { function e(a, b) { var c = new RegExp("{" + a + "}", "ig"); d = d.replace(c, b) } if (a) { var d = a.lazyImageTemplate || ""; b.each(a, e), b.each(c, e), a.carouselEle.slick("slickAdd", d) } } b.ajax({ type: "POST", url: c() + "/include/ajax/api.aspx?op=GetListingsImages", data: { listingids: e.join(), skip: 1 } }).done(function (c) { var e = c.Entity; b.each(e, function (c, e) { var f = d.listings[e.ListingId]; if(f != undefined) b.each(e.Images, function (b, c) { a(f, c), f.loadedImages = f.loadedImages + 1 }) }) }) } var d = this, e = []; e = b.grep(f(), g), 0 !== e.length && h() }, lazyLoadListingImagesHandler: function (b) { var c = this; null !== c.lazyLoadListingImagesTimer && a.clearTimeout(c.lazyLoadListingImagesTimer), c.lazyLoadListingImagesTimer = a.setTimeout(function () { c.lazyLoadListingImagesInView() }, b) } }, a.addEventListener("scroll", function () { a.rbw.slickListingImageCarousel.lazyLoadListingImagesHandler(100) }, !1) }(window, jQuery, getAppRoot);